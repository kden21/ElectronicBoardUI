{"ast":null,"code":"import _asyncToGenerator from \"K:/Coding/SolarLab/TechnicalTask/UI/Angular/ElectronicBoardUI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  constructor(http) {\n    this.http = http;\n  }\n\n  login(account) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const jwt = yield _this.http.post('https://localhost:7097/v1/account/login', account);\n\n      if (jwt.errors) {\n        return jwt.errors;\n      }\n\n      const user = yield _this.getById(jwt.id).toPromise();\n      user.jwtToken = jwt.token;\n      localStorage.setItem('user', JSON.stringify(user));\n    })();\n  }\n\n}\n\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n};\n\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":";;;AAUA,OAAM,MAAOA,WAAP,CAAkB;EAEtBC,YAAoBC,IAApB,EAAoC;IAAhB;EACnB;;EAEYC,KAAK,CAACC,OAAD,EAAiB;IAAA;;IAAA;MACjC,MAAMC,GAAG,SAAS,KAAI,CAACH,IAAL,CAAUI,IAAV,CAAuB,yCAAvB,EAAkEF,OAAlE,CAAlB;;MACA,IAAIC,GAAG,CAACE,MAAR,EAAgB;QACd,OAAOF,GAAG,CAACE,MAAX;MACD;;MACD,MAAMC,IAAI,SAAS,KAAI,CAACC,OAAL,CAAaJ,GAAG,CAACK,EAAjB,EAAqBC,SAArB,EAAnB;MACAH,IAAI,CAACI,QAAL,GAAgBP,GAAG,CAACQ,KAApB;MACAC,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6BC,IAAI,CAACC,SAAL,CAAeT,IAAf,CAA7B;IAPiC;EAQlC;;AAbqB;;;mBAAXR,aAAWkB;AAAA;;;SAAXlB;EAAWmB,SAAXnB,WAAW;EAAAoB,YAJV","names":["AuthService","constructor","http","login","account","jwt","post","errors","user","getById","id","toPromise","jwtToken","token","localStorage","setItem","JSON","stringify","i0","factory","providedIn"],"sourceRoot":"","sources":["K:\\Coding\\SolarLab\\TechnicalTask\\UI\\Angular\\ElectronicBoardUI\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import {HttpClient} from \"@angular/common/http\";\r\nimport {Observable} from \"rxjs\";\r\nimport {Injectable} from \"@angular/core\";\r\nimport {IAccount} from \"../models/account\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\n\r\n\r\nexport class AuthService{\r\n\r\n  constructor(private http: HttpClient) {\r\n  }\r\n\r\n  public async login(account:IAccount): Promise<string[] | void>{\r\n    const jwt = await this.http.post<string>('https://localhost:7097/v1/account/login', account);\r\n    if (jwt.errors) {\r\n      return jwt.errors;\r\n    }\r\n    const user = await this.getById(jwt.id).toPromise();\r\n    user.jwtToken = jwt.token;\r\n    localStorage.setItem('user', JSON.stringify(user));\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}